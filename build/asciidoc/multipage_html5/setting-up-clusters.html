<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Setting Up Clusters</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article">
<div id="content">
<div class="sect1">
<h2 id="setting-up-clusters">5. Setting Up Clusters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes Hazelcast clusters and the methods cluster members and native clients use to form a Hazelcast cluster.</p>
</div>
<div class="sect2">
<h3 id="discovery-mechanisms">5.1. Discovery Mechanisms</h3>
<div class="paragraph">
<p>A Hazelcast cluster is a network of cluster members that run Hazelcast. Cluster members (also called nodes) automatically join together to form a cluster. This automatic joining takes place with various discovery mechanisms that the cluster members use to find each other.</p>
</div>
<div class="paragraph">
<p>Please note that, after a cluster is formed, communication between cluster members is always via TCP/IP, regardless of the discovery mechanism used.</p>
</div>
<div class="paragraph">
<p>Hazelcast uses the following discovery mechanisms.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can refer to the <a href="https://hazelcast.com/resources/hazelcast-deployment-operations-guide/">Hazelcast IMDG Deployment and Operations Guide</a> for advice on the best discovery mechanism to use.*
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="tcp">5.1.1. TCP</h4>
<div class="paragraph">
<p>You can configure Hazelcast to be a full TCP/IP cluster. Please see the <a href="#discovering-members-by-tcp">Discovering Members by TCP</a> section for configuration details.</p>
</div>
</div>
<div class="sect3">
<h4 id="multicast">5.1.2. Multicast</h4>
<div class="paragraph">
<p>Multicast mechanism is not recommended for production since UDP is often blocked in production environments and other discovery mechanisms are more definite.</p>
</div>
<div class="paragraph">
<p>With this mechanism, Hazelcast allows cluster members to find each other using multicast communication. Please see the <a href="#discovering-members-by-multicast">Discovering Members by Multicast</a> section.</p>
</div>
</div>
<div class="sect3">
<h4 id="aws-cloud-discovery">5.1.3. AWS Cloud Discovery</h4>
<div class="paragraph">
<p>Hazelcast supports EC2 auto-discovery. It is useful when you do not want to provide or you cannot provide the list of possible IP addresses. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/hazelcast/hazelcast-aws/blob/master/README.md">documentation</a> for information on configuring and using it.</p>
</div>
</div>
<div class="sect3">
<h4 id="apache-jclous-cloud-discovery">5.1.4. Apache jclouds® Cloud Discovery</h4>
<div class="paragraph">
<p>Hazelcast members and native clients support jclouds® for discovery. This mechanism allows applications to be deployed in various cloud infrastructure ecosystems in an infrastructure-agnostic way. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/hazelcast/hazelcast-jclouds/blob/master/README.md">documentation</a> for information on configuring and using it.</p>
</div>
</div>
<div class="sect3">
<h4 id="azure-cloud-discovery">5.1.5. Azure Cloud Discovery</h4>
<div class="paragraph">
<p>Hazelcast offers a discovery strategy for your Hazelcast applications running on Azure. This strategy provides all of your Hazelcast instances by returning the virtual machines within your Azure resource group that are tagged with a specified value. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/hazelcast/hazelcast-azure/blob/master/README.md">documentation</a> for information on configuring and using it.</p>
</div>
</div>
<div class="sect3">
<h4 id="zookeeper-cloud-discovery">5.1.6. Zookeeper Cloud Discovery</h4>
<div class="paragraph">
<p>This discovery mechanism provides a service based discovery strategy by using Apache Curator to communicate with your Zookeeper server. You can use this plugin with <a href="#discovery-spi">Discovery SPI</a> enabled Hazelcast 3.6.1 and higher applications. This is provided as a Hazelcast plugin. Please see its <a href="https://github.com/hazelcast/hazelcast-zookeeper/blob/master/README.md">documentation</a> for information on configuring and using it.</p>
</div>
</div>
<div class="sect3">
<h4 id="condul-cloud-discovery">5.1.7. Consul Cloud Discovery</h4>
<div class="paragraph">
<p>Consul is a highly available and distributed service discovery and key-value store designed with support for the modern data center to make distributed systems and configuration easy. This mechanism provides a Consul based discovery strategy for Hazelcast enabled applications (Hazelcast 3.6 and higher) and enables Hazelcast members to dynamically discover one another via Consul. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/bitsofinfo/hazelcast-consul-discovery-spi">documentation</a> for information on configuring and using it.</p>
</div>
</div>
<div class="sect3">
<h4 id="etcd-cloud-discovery">5.1.8. etcd Cloud Discovery</h4>
<div class="paragraph">
<p>This mechanism provides an <a href="https://coreos.com/etcd/">etcd</a> based discovery strategy for Hazelcast enabled applications (Hazelcast 3.6 and higher). This is an easy to configure plug-and-play Hazelcast discovery strategy that will optionally register each of your Hazelcast members with etcd and enable Hazelcast members to dynamically discover one another via etcd. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/bitsofinfo/hazelcast-etcd-discovery-spi/blob/master/README.md">documentation</a> for information on configuring and using it.</p>
</div>
</div>
<div class="sect3">
<h4 id="hazelcast-for-pcf">5.1.9. Hazelcast for PCF</h4>
<div class="paragraph">
<p>Using a clickable Hazelcast Tile for Pivotal Cloud Foundry (PCF), you can deploy your Hazelcast cluster on PCF. This feature is provided as a Hazelcast plugin. Please see its <a href="https://docs.pivotal.io/partners/hazelcast/index.html">documentation</a> on how to install, configure and use the plugin Hazelcast for PCF.</p>
</div>
</div>
<div class="sect3">
<h4 id="hazelcast-openshift-integration">5.1.10. Hazelcast OpenShift Integration</h4>
<div class="paragraph">
<p>Hazelcast can run inside OpenShift benefiting from its cluster management software Kubernetes for discovery of members. Using Hazelcast Docker images, templates and default configuration files, you can deploy Hazelcast IMDG and Hazelcast IMDG Enterprise onto OpenShift. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/hazelcast/hazelcast-openshift">documentation</a> for information on this deployment.</p>
</div>
</div>
<div class="sect3">
<h4 id="eureka-cloud-discovery">5.1.11. Eureka Cloud Discovery</h4>
<div class="paragraph">
<p>Eureka is a REST based service that is primarily used in the AWS cloud for locating services for the purpose of load balancing and failover of middle-tier servers. Hazelcast supports Eureka V1 discovery; Hazelcast members within EC2 Virtual Private Cloud can discover each other using this mechanism. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/hazelcast/hazelcast-eureka">documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="heroku-cloud-discovery">5.1.12. Heroku Cloud Discovery</h4>
<div class="paragraph">
<p>Heroku is a platform as a service (PaaS) with which you can build, run, and operate applications entirely in the cloud. It is a cloud platform based on a managed container system, with integrated data services and a powerful ecosystem. Hazelcast offers a discovery plugin that looks for IP addresses of other members by resolving service names against the Heroku DNS Discovery in Heroku Private Spaces. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/jkutner/hazelcast-heroku-discovery/blob/master/README.md">documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="kubernetes-cloud-discovery">5.1.13. Kubernetes Cloud Discovery</h4>
<div class="paragraph">
<p>Kubernetes is an open source system for automating deployment, scaling, and management of containerized applications. Hazelcast provides Kubernetes discovery mechanism that looks for IP addresses of other members by resolving the requests against a Kubernetes Service Discovery system. It supports two different options of resolving against the discovery registry: (i) a request to the REST API, (ii) DNS Lookup against a given DNS service name. This discovery feature is provided as a Hazelcast plugin. Please see its <a href="https://github.com/hazelcast/hazelcast-kubernetes/blob/master/README.adoc">documentation</a> for information on configuring and using it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="discovering-members-by-tcp">5.2. Discovering Members by TCP</h3>
<div class="paragraph">
<p>If multicast is not the preferred way of discovery for your environment, then you can configure Hazelcast to be a full TCP/IP cluster. When you configure Hazelcast to discover members by TCP/IP, you must list all or a subset of the members' hostnames and/or IP addresses as cluster members. You do not have to list all of these cluster members, but at least one of the listed members has to be active in the cluster when a new member joins.</p>
</div>
<div class="paragraph">
<p>To set your Hazelcast to be a full TCP/IP cluster, set the following configuration elements. Please refer to the <a href="#tcp-ip-element">tcp-ip element section</a> for the full description of the TCP/IP discovery configuration elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the <code>enabled</code> attribute of the <code>multicast</code> element to "false".</p>
</li>
<li>
<p>Set the <code>enabled</code> attribute of the <code>aws</code> element to "false".</p>
</li>
<li>
<p>Set the <code>enabled</code> attribute of the <code>tcp-ip</code> element to "true".</p>
</li>
<li>
<p>Set your <code>member</code> elements within the <code>tcp-ip</code> element.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example declarative configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;hazelcast&gt;
   ...
  &lt;network&gt;
    ...
    &lt;join&gt;
      &lt;multicast enabled="false"&gt;
      &lt;/multicast&gt;
      &lt;tcp-ip enabled="true"&gt;
        &lt;member&gt;machine1&lt;/member&gt;
        &lt;member&gt;machine2&lt;/member&gt;
        &lt;member&gt;machine3:5799&lt;/member&gt;
        &lt;member&gt;192.168.1.0-7&lt;/member&gt;
        &lt;member&gt;192.168.1.21&lt;/member&gt;
      &lt;/tcp-ip&gt;
      ...
    &lt;/join&gt;
    ...
  &lt;/network&gt;
  ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown above, you can provide IP addresses or hostnames for <code>member</code> elements. You can also give a range of IP addresses, such as <code>192.168.1.0-7</code>.</p>
</div>
<div class="paragraph">
<p>Instead of providing members line-by-line as shown above, you also have the option to use the <code>members</code> element and write comma-separated IP addresses, as shown below.</p>
</div>
<div class="paragraph">
<p><code>&lt;members&gt;192.168.1.0-7,192.168.1.21&lt;/members&gt;</code></p>
</div>
<div class="paragraph">
<p>If you do not provide ports for the members, Hazelcast automatically tries the ports 5701, 5702, and so on.</p>
</div>
<div class="paragraph">
<p>By default, Hazelcast binds to all local network interfaces to accept incoming traffic. You can change this behavior using the system property <code>hazelcast.socket.bind.any</code>. If you set this property to <code>false</code>, Hazelcast uses the interfaces specified in the <code>interfaces</code> element (please refer to the <a href="#interfaces">Interfaces Configuration section</a>). If no interfaces are provided, then it will try to resolve one interface to bind from the <code>member</code> elements.</p>
</div>
</div>
<div class="sect2">
<h3 id="discovering-members-by-multicast">5.3. Discovering Members by Multicast</h3>
<div class="paragraph">
<p>With the multicast auto-discovery mechanism, Hazelcast allows cluster members to find each other using multicast communication. The cluster members do not need to know the concrete addresses of the other members, as they just multicast to all the other members for listening. Whether multicast is possible or allowed depends on your environment.</p>
</div>
<div class="paragraph">
<p>To set your Hazelcast to multicast auto-discovery, set the following configuration elements. Please refer to the <a href="#multicast-element">multicast element section</a> for the full description of the multicast discovery configuration elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the <code>enabled</code> attribute of the <code>multicast</code> element to "true".</p>
</li>
<li>
<p>Set <code>multicast-group</code>, <code>multicast-port</code>, <code>multicast-time-to-live</code>, etc. to your multicast values.</p>
</li>
<li>
<p>Set the <code>enabled</code> attribute of both <code>tcp-ip</code> and <code>aws</code> elements to "false".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example declarative configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;hazelcast&gt;
   ...
  &lt;network&gt;
    ...
        &lt;join&gt;
            &lt;multicast enabled="true"&gt;
                &lt;multicast-group&gt;224.2.2.3&lt;/multicast-group&gt;
                &lt;multicast-port&gt;54327&lt;/multicast-port&gt;
                &lt;multicast-time-to-live&gt;32&lt;/multicast-time-to-live&gt;
                &lt;multicast-timeout-seconds&gt;2&lt;/multicast-timeout-seconds&gt;
                &lt;trusted-interfaces&gt;
                   &lt;interface&gt;192.168.1.102&lt;/interface&gt;
                &lt;/trusted-interfaces&gt;
            &lt;/multicast&gt;
            &lt;tcp-ip enabled="false"&gt;
            &lt;/tcp-ip&gt;
            &lt;aws enabled="false"&gt;
            &lt;/aws&gt;
        &lt;/join&gt;
  &lt;/network&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pay attention to the <code>multicast-timeout-seconds</code> element. <code>multicast-timeout-seconds</code> specifies the time in seconds that a member should wait for a valid multicast response from another member running in the network before declaring itself the leader member (the first member joined to the cluster) and creating its own cluster. This only applies to the startup of members where no leader has been assigned yet. If you specify a high value to <code>multicast-timeout-seconds</code>, such as 60 seconds, it means that until a leader is selected, each member will wait 60 seconds before moving on. Be careful when providing a high value. Also, be careful not to set the value too low, or the members might give up too early and create their own cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Multicast auto-discovery is not supported for Hazelcast native clients yet. However, we offer Multicast Discovery Plugin for this purpose. Please refer to the <a href="#discovering-native-clients">Discovering Native Clients section</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="discovering-native-clients">5.4. Discovering Native Clients</h3>
<div class="paragraph">
<p>Hazelcast members and native Java clients can find each other with multicast discovery plugin. This plugin is implemented using <a href="#discovery-spi">Hazelcast Discovery SPI</a>. You should configure the plugin both at Hazelcast members and Java clients in order to use multicast discovery.</p>
</div>
<div class="paragraph">
<p>To configure your cluster to have the multicast discovery plugin, follow these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disable the multicast and TCP/IP join mechanisms. To do this, set the <code>enabled</code> attributes of the <code>multicast</code> and <code>tcp-ip</code> elements to <code>false</code> in your <code>hazelcast.xml</code> configuration file</p>
</li>
<li>
<p>Set the <code>enabled</code> attribute of the <code>hazelcast.discovery.enabled</code> property to <code>true</code>.</p>
</li>
<li>
<p>Add multicast discovery strategy configuration to your XML file, i.e., <code>&lt;discovery-strategies&gt;</code> element.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example declarative configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> ...
  &lt;properties&gt;
    &lt;property name="hazelcast.discovery.enabled"&gt;true&lt;/property&gt;
  &lt;/properties&gt;
   ....
 &lt;join&gt;
    &lt;multicast enabled="false"&gt;
    &lt;/multicast&gt;
    &lt;tcp-ip enabled="false"&gt;
    &lt;/tcp-ip&gt;
    &lt;discovery-strategies&gt;
        &lt;discovery-strategy class="com.hazelcast.spi.discovery.multicast.MulticastDiscoveryStrategy" enabled="true"&gt;
          &lt;properties&gt;
          &lt;property name="group"&gt;224.2.2.3&lt;/property&gt;
          &lt;property name="port"&gt;54327&lt;/property&gt;
          &lt;/properties&gt;
        &lt;/discovery-strategy&gt;
    &lt;/discovery-strategies&gt;
&lt;/join&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following are the multicast discovery plugin configuration properties with their descriptions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>group</code>: String value that is used to set the multicast group, so that you can isolate your clusters.</p>
</li>
<li>
<p><code>port</code>: Integer value that is used to set the multicast port.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="creating-cluster-groups">5.5. Creating Cluster Groups</h3>
<div class="paragraph">
<p>You can create cluster groups. To do this, use the <code>group</code> configuration element.</p>
</div>
<div class="paragraph">
<p>You can separate your clusters in a simple way by specifying group names. Example groupings can be by <strong>development</strong>, <strong>production</strong>, <strong>test</strong>, <strong>app</strong>, etc. The following is an example declarative configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;hazelcast&gt;
  &lt;group&gt;
    &lt;name&gt;production&lt;/name&gt;
  &lt;/group&gt;
  ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also define the cluster groups using the programmatic configuration. A JVM can host multiple Hazelcast instances. Each Hazelcast instance can only participate in one group. Each Hazelcast instance only joins to its own group and does not interact with other groups. The following code example creates three separate Hazelcast instances--<code>h1</code> belongs to the <code>production</code> cluster, while <code>h2</code> and <code>h3</code> belong to the <code>development</code> cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config configProd = new Config();
configProd.getGroupConfig().setName( "production" );

Config configDev = new Config();
configDev.getGroupConfig().setName( "development" );

HazelcastInstance h1 = Hazelcast.newHazelcastInstance( configProd );
HazelcastInstance h2 = Hazelcast.newHazelcastInstance( configDev );
HazelcastInstance h3 = Hazelcast.newHazelcastInstance( configDev );</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="cluster-groups-before-hazelcast-382">5.5.1. Cluster Groups before Hazelcast 3.8.2</h4>
<div class="paragraph">
<p>If you have a Hazelcast release older than 3.8.2, you need to provide also a group password along with the group name. The following are the configuration examples with the password element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;hazelcast&gt;
  &lt;group&gt;
    &lt;name&gt;production&lt;/name&gt;
    &lt;password&gt;prod-pass&lt;/password&gt;
  &lt;/group&gt;
  ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config configProd = new Config();
configProd.getGroupConfig().setName( "production" ).setPassword( "prod-pass" );

Config configDev = new Config();
configDev.getGroupConfig().setName( "development" ).setPassword( "dev-pass" );

HazelcastInstance h1 = Hazelcast.newHazelcastInstance( configProd );
HazelcastInstance h2 = Hazelcast.newHazelcastInstance( configDev );
HazelcastInstance h3 = Hazelcast.newHazelcastInstance( configDev );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Starting with 3.8.2, there is no need for a group password.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="member-user-code-deployment-beta">5.6. Member User Code Deployment - BETA</h3>
<div class="paragraph">
<p>Hazelcast can dynamically load your custom classes or domain classes from a remote class repository, which typically includes <a href="#enabling-lite-members">lite members</a>. For this purpose Hazelcast offers a distributed  dynamic class loader.</p>
</div>
<div class="paragraph">
<p>Using this dynamic class loader, you can control the local caching of the classes loaded from other members,
control the classes to be served to other members, and create blacklists or whitelists of classes and packages. When you enable this feature, you will not have to deploy your classes to all cluster members.</p>
</div>
<div class="paragraph">
<p>The following is the brief working mechanism of the User Code Deployment feature:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Dynamic class loader first checks the local classes, i.e., your classpath, for your custom class. If it is there, Hazelcast does not try to load it from the remote class repository.</p>
</li>
<li>
<p>Then, it checks the cache of classes loaded from the remote class repository (for this, caching should have been enabled in your local, please refer to <a href="#configuring-user-code-deployment">Configuring User Code Deployment section</a>). If your class is found here, again, Hazelcast does not try to load it from the remote class repository.</p>
</li>
<li>
<p>Finally, dynamic class loader checks the remote class repository. If a member in this repository returns the class, it means your class is found and will be used. You can also put this class into your local class cache as mentioned in the previous step.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="configuring-user-code-deployment">5.6.1. Configuring User Code Deployment</h4>
<div class="paragraph">
<p>User Code Deployment feature is not enabled by default. You can configure this feature declaratively or programmatically. Following are example configuration snippets:</p>
</div>
<div class="paragraph">
<p><strong>Declarative Configuration</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;user-code-deployment enabled="true"&gt;
	&lt;class-cache-mode&gt;ETERNAL&lt;/class-cache-mode&gt;
	&lt;provider-mode&gt;LOCAL_CLASSES_ONLY&lt;/provider-mode&gt;
	&lt;blacklist-prefixes&gt;com.foo&lt;/blacklist-prefixes&gt;
	&lt;whitelist-prefixes&gt;com.bar.MyClass&lt;/whitelist-prefixes&gt;
	&lt;provider-filter&gt;HAS_ATTRIBUTE:lite&lt;/provider-filter&gt;
&lt;/user-code-deployment&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic Configuration</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config();
UserCodeDeploymentConfig distCLConfig = config.getUserCodeDeploymentConfig();
distCLConfig.setEnabled( true )
        .setClassCacheMode( ClassCacheMode.ETERNAL )
        .setProviderMode( ProviderMode.LOCAL_CLASSES_ONLY )
        .setBlacklistedPrefixes( "com.foo" )
        .setWhitelistedPrefixes( "com.bar.MyClass" )
        .setProviderFilter( "HAS_ATTRIBUTE:lite" );</code></pre>
</div>
</div>
<div class="paragraph">
<p>User Code Deployment has the following configuration elements and attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: Specifies whether dynamic class loading is enabled or not. Its default value is "true" and it is a mandatory attribute.</p>
</li>
<li>
<p><code>&lt;class-cache-mode&gt;</code>: Controls the local caching behavior for the classes loaded from the remote class repository. Available values are as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>ETERNAL</code>: Cache the loaded classes locally. This is the default value and suitable when you load long-living objects, such as domain objects stored in a map.</p>
</li>
<li>
<p><code>OFF</code>: Do not cache the loaded classes locally. It is suitable for loading runnables, callables, entry processors, etc.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>&lt;provider-mode&gt;</code>: Controls how the classes are served to the other cluster members. Available values are as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>LOCAL_AND_CACHED_CLASSES</code>: Serve classes loaded from both local classpath and from other members. This is the default value.</p>
</li>
<li>
<p><code>LOCAL_CLASSES_ONLY</code>: Serve classes from the local classpath only. Classes loaded from other members will be used locally, but they are not served to other members.</p>
</li>
<li>
<p><code>OFF</code>: Never serve classes to other members.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>&lt;blacklist-prefixes&gt;</code>: Comma separated name prefixes of classes/packages to be prevented from dynamic class loading. For example, if you set it as "com.foo", remote loading of all classes from the "com.foo" package will be blacklisted, including the classes from all its sub-packages. If you set it as "com.foo.Class", then the "Class" and all classes having the "Class" as prefix in the "com.foo" package will be blacklisted. There are some built-in prefixes which are blacklisted by default. These are as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>javax.</code></p>
</li>
<li>
<p><code>java.</code></p>
</li>
<li>
<p><code>sun.</code></p>
</li>
<li>
<p><code>com.hazelcast.</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>&lt;whitelist-prefixes&gt;</code>: Comma separated name prefixes of classes/packages only from which the classes will be loaded. It allows to quickly configure remote loading only for classes from selected packages. It can be used together with blacklisting. For example, you can whitelist the prefix "com.foo" and blacklist the prefix "com.foo.secret".</p>
</li>
<li>
<p><code>&lt;provider-filter&gt;</code>: Filter to constraint members to be used for a class loading request when a class is not available locally. The value is in the format "HAS_ATTRIBUTE:foo". When it is set as "HAS_ATTRIBUTE:foo", the class loading request will only be sent to the members which have "foo" as a <a href="#defining-member-attributes">member attribute</a>. Setting this to null will allow to load classes from all members. Please see an example in the below section.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-for-filtering-members">5.6.2. Example for Filtering Members</h4>
<div class="paragraph">
<p>As described above, the configuration element <code>provider-filter</code> is used to constrain a member to load classes only from a subset of all cluster members. The value of the <code>provider-filter</code> must be set as a member attribute in the desired members from which the classes will be loaded. Please see the following example usage provided as programmatic configurations.</p>
</div>
<div class="paragraph">
<p>The below example configuration will allow the Hazelcast member to load classes only from members with the <code>class-provider</code> attribute set. It will not ask any other member to provide a locally unavailable class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config hazelcastConfig = new Config();
DistributedClassloadingConfig distributedClassloadingConfig = hazelcastConfig.getDistributedClassloadingConfig();
distributedClassloadingConfig.setProviderFilter("HAS_ATTRIBUTE:class-provider");

HazecastInstance instance = Hazelcast.newHazelcastInstance(hazelcastConfig);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the below example configuration sets the attribute <code>class-provider</code> for a member. So, the above member will load classes from the members who have the attribute <code>class-provider</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config hazelcastConfig = new Config();
MemberAttributeConfig memberAttributes = hazelcastConfig.getMemberAttributeConfig();
memberAttributes.setAttribute("class-provider", "true");

HazecastInstance instance = Hazelcast.newHazelcastInstance(hazelcastConfig);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="client-user-code-deployment-beta">5.7. Client User Code Deployment - BETA</h3>
<div class="paragraph">
<p>You can use the User Code Deployment at the client side for the following situations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You have objects that will run on the cluster via the clients such as <code>Runnable</code>, <code>Callable</code>, and Entry Processors.</p>
</li>
<li>
<p>You have new or amended user domain objects (in-memory format of the IMap set to <code>Object</code>) which need to be deployed into the cluster.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When this feature is enabled, the clients will deploy these classes to the members. By this way, when a client adds a new class, the members will not require restarts to include the new classes in classpath.</p>
</div>
<div class="paragraph">
<p>You can also use the client permission policy to specify which clients are permitted to use User Code Deployment. Please see the <a href="#permissions">Permissions</a>.</p>
</div>
<div class="sect3">
<h4 id="configuring-client-user-code-deployment">5.7.1. Configuring Client User Code Deployment</h4>
<div class="paragraph">
<p>Client User Code Deployment feature is not enabled by default. You can configure this feature declaratively or programmatically. Following are example configuration snippets:</p>
</div>
<div class="paragraph">
<p><strong>Declarative Configuration</strong></p>
</div>
<div class="paragraph">
<p>In your <code>hazelcast-client.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;user-code-deployment enabled="true"&gt;
    &lt;jarPaths&gt;
        &lt;jarPath&gt;/User/sample/sample.jar&lt;/jarPath&gt;
        &lt;jarPath&gt;sample.jar&lt;/jarPath&gt; &lt;!--from class path --&gt;
        &lt;jarPath&gt;https://com.sample.com/sample.jar&lt;/jarPath&gt;
        &lt;jarPath&gt;file://Users/sample/sample.jar&lt;/jarPath&gt;
    &lt;/jarPaths&gt;
    &lt;classNames&gt;
    	&lt;!-- for the classes available in client class path --&gt;
        &lt;className&gt;sample.ClassName&lt;/className&gt;
        &lt;className&gt;sample.ClassName2&lt;/className&gt;
    &lt;/classNames&gt;
&lt;/user-code-deployment&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic Configuration</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ClientConfig clientConfig = new ClientConfig();
ClientUserCodeDeploymentConfig clientUserCodeDeploymentConfig = new ClientUserCodeDeploymentConfig();

clientUserCodeDeploymentConfig.addJar("/User/sample/sample.jar");
clientUserCodeDeploymentConfig.addJar("https://com.sample.com/sample.jar");
clientUserCodeDeploymentConfig.addClass("sample.ClassName");
clientUserCodeDeploymentConfig.addClass("sample.ClassName2");

clientUserCodeDeploymentConfig.setEnabled(true);
clientConfig.setUserCodeDeploymentConfig(clientUserCodeDeploymentConfig);</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="client-user-code-deployment-note">Important to Know</h5>
<div class="paragraph">
<p>Note that User Code Deployment should also be enabled on the members to use this feature.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config();
UserCodeDeploymentConfig userCodeDeploymentConfig = config.getUserCodeDeploymentConfig();
userCodeDeploymentConfig.setEnabled( true );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please refer to the <a href="#member-user-code-deployment-beta">Member User Code Deployment section</a> for more information on enabling it on the member side and its configuration properties.</p>
</div>
<div class="paragraph">
<p>For the property <code>class-cache-mode</code>, Client User Code Deployment supports only the <code>ETERNAL</code> mode, regardless of the configuration set at the member side (which can be <code>ETERNAL</code> and <code>OFF</code>).</p>
</div>
<div class="paragraph">
<p>For the property, <code>provider-mode</code>, Client User Code Deployment supports only the <code>LOCAL_AND_CACHED_CLASSES</code> mode, regardless of the configuration set at the member side (which can be <code>LOCAL_AND_CACHED_CLASSES</code>, <code>LOCAL_CLASSES_ONLY</code> and <code>OFF</code>).</p>
</div>
<div class="paragraph">
<p>The remaining properties, which are <code>blacklist-prefixes</code>, <code>whitelist-prefixes</code> and <code>provider-filter</code> configured at the member side, will effect the client user code deployment&#8217;s behavior too. For example, assuming that you provide <code>com.foo</code> as a blacklist prefix at the member side, the member will discard the classes with the prefix <code>com.foo</code> loaded by the client.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="partition-group-configuration">5.8. Partition Group Configuration</h3>
<div class="paragraph">
<p>Hazelcast distributes key objects into partitions using the consistent hashing algorithm. Multiple replicas are created for each partition and those partition replicas are distributed among Hazelcast members. An entry is stored in the members that own replicas of the partition to which the entry&#8217;s key is assigned. The total partition count is 271 by default; you can change it with the configuration property <code>hazelcast.partition.count</code>. Please see the <a href="#system-properties">System Properties section</a>.</p>
</div>
<div class="paragraph">
<p>Hazelcast member that owns the primary replica of a partition is called as partition owner. Other replicas are called backups. Based on the configuration, a key object can be kept in multiple replicas of a partition. A member can hold at most one replica of a partition (ownership or backup).</p>
</div>
<div class="paragraph">
<p>By default, Hazelcast distributes partition replicas randomly and equally among the cluster members, assuming all members in the cluster are identical. But what if some members share the same JVM or physical machine or chassis and you want backups of these members to be assigned to members in another machine or chassis? What if processing or memory capacities of some members are different and you do not want an equal number of partitions to be assigned to all members?</p>
</div>
<div class="paragraph">
<p>To deal with such scenarios, you can group members in the same JVM (or physical machine) or members located in the same chassis. Or you can group members to create identical capacity. We call these groups <strong>partition groups</strong>. Partitions are assigned to those partition groups instead of individual members. Backup replicas of a partition which is owned by a partition group are located in other partition groups.</p>
</div>
<div class="sect3">
<h4 id="grouping-types">5.8.1. Grouping Types</h4>
<div class="paragraph">
<p>When you enable partition grouping, Hazelcast presents the following choices for you to configure partition groups.</p>
</div>
<div class="paragraph">
<p><strong>1. HOST_AWARE:</strong></p>
</div>
<div class="paragraph">
<p>You can group members automatically using the IP addresses of members, so members sharing the same network interface will be grouped together. All members on the same host (IP address or domain name) will be a single partition group. This helps to avoid data loss when a physical server crashes, because multiple replicas of the same partition are not stored on the same host. But if there are multiple network interfaces or domain names per physical machine, that will make this assumption invalid.</p>
</div>
<div class="paragraph">
<p>Following are declarative and programmatic configuration snippets that show how to enable HOST_AWARE grouping.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;partition-group enabled="true" group-type="HOST_AWARE" /&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = ...;
PartitionGroupConfig partitionGroupConfig = config.getPartitionGroupConfig();
partitionGroupConfig.setEnabled( true )
    .setGroupType( MemberGroupType.HOST_AWARE );</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>2. CUSTOM:</strong></p>
</div>
<div class="paragraph">
<p>You can do custom grouping using Hazelcast&#8217;s interface matching configuration. This way, you can add different and multiple interfaces to a group. You can also use wildcards in the interface addresses. For example, the users can create rack-aware or data warehouse partition groups using custom partition grouping.</p>
</div>
<div class="paragraph">
<p>Following are declarative and programmatic configuration examples that show how to enable and use CUSTOM grouping.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;partition-group enabled="true" group-type="CUSTOM"&gt;
&lt;member-group&gt;
  &lt;interface&gt;10.10.0.*&lt;/interface&gt;
  &lt;interface&gt;10.10.3.*&lt;/interface&gt;
  &lt;interface&gt;10.10.5.*&lt;/interface&gt;
&lt;/member-group&gt;
&lt;member-group&gt;
  &lt;interface&gt;10.10.10.10-100&lt;/interface&gt;
  &lt;interface&gt;10.10.1.*&lt;/interface&gt;
  &lt;interface&gt;10.10.2.*&lt;/interface&gt;
&lt;/member-group&gt;
&lt;/partition-group&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = ...;
PartitionGroupConfig partitionGroupConfig = config.getPartitionGroupConfig();
partitionGroupConfig.setEnabled( true )
    .setGroupType( MemberGroupType.CUSTOM );

MemberGroupConfig memberGroupConfig = new MemberGroupConfig();
memberGroupConfig.addInterface( "10.10.0.*" )
.addInterface( "10.10.3.*" ).addInterface("10.10.5.*" );

MemberGroupConfig memberGroupConfig2 = new MemberGroupConfig();
memberGroupConfig2.addInterface( "10.10.10.10-100" )
.addInterface( "10.10.1.*").addInterface( "10.10.2.*" );

partitionGroupConfig.addMemberGroupConfig( memberGroupConfig );
partitionGroupConfig.addMemberGroupConfig( memberGroupConfig2 );</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
While your cluster was forming, if you configured your members to discover each other by their IP addresses, you should use the IP addresses for the <code>&lt;interface&gt;</code> element. If your members discovered each other by their hostnames, you should use the hostnames.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>3. PER_MEMBER:</strong></p>
</div>
<div class="paragraph">
<p>You can give every member its own group. Each member is a group of its own and primary and backup partitions are distributed randomly (not on the same physical member). This gives the least amount of protection and is the default configuration for a Hazelcast cluster. This grouping type provides good redundancy when Hazelcast members are on separate hosts. However, if multiple instances run on the same host, this type is not a good option.</p>
</div>
<div class="paragraph">
<p>Following are declarative and programmatic configuration snippets that show how to enable PER_MEMBER grouping.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;partition-group enabled="true" group-type="PER_MEMBER" /&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = ...;
PartitionGroupConfig partitionGroupConfig = config.getPartitionGroupConfig();
partitionGroupConfig.setEnabled( true )
    .setGroupType( MemberGroupType.PER_MEMBER );</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>4. ZONE_AWARE:</strong></p>
</div>
<div class="paragraph">
<p>You can use ZONE_AWARE configuration with <a href="https://github.com/hazelcast/hazelcast-aws">Hazelcast AWS</a>, <a href="https://github.com/hazelcast/hazelcast-jclouds">Hazelcast jclouds</a> or <a href="https://github.com/hazelcast/hazelcast-azure">Hazelcast Azure</a> Discovery Service plugins.</p>
</div>
<div class="paragraph">
<p>As discovery services, these plugins put zone information to the Hazelcast <a href="#defining-member-attributes">member attributes</a> map during the discovery process. When ZONE_AWARE is configured as partition group type, Hazelcast creates the partition groups with respect to member attributes map entries that include zone information.That means backups are created in the other zones and each zone will be accepted as one partition group.</p>
</div>
<div class="paragraph">
<p>This is the list of supported attributes which is set by Discovery Service plugins during a Hazelcast member start-up:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.partition.group.zone</code>: For the zones in the same area.</p>
</li>
<li>
<p><code>hazelcast.partition.group.rack</code>: For different racks in the same zone.</p>
</li>
<li>
<p><code>hazelcast.partition.group.host</code>: For a shared physical member if virtualization is used.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
hazelcast-jclouds offers rack or host information in addition to zone information based on cloud provider. In such cases, Hazelcast looks for zone, rack, and host information in the given order and create partition groups with available information*
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Following are declarative and programmatic configuration snippets that show how to enable ZONE_AWARE grouping.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;partition-group enabled="true" group-type="ZONE_AWARE" /&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = ...;
PartitionGroupConfig partitionGroupConfig = config.getPartitionGroupConfig();
partitionGroupConfig.setEnabled( true )
    .setGroupType( MemberGroupType.ZONE_AWARE );</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>5. SPI:</strong></p>
</div>
<div class="paragraph">
<p>You can provide your own partition group implementation using the SPI configuration. To create your partition group implementation, you need to first extend the <code>DiscoveryStrategy</code> class of the discovery service plugin, override the method <code>public PartitionGroupStrategy getPartitionGroupStrategy()</code>, and return the <code>PartitionGroupStrategy</code> configuration in that overridden method.</p>
</div>
<div class="paragraph">
<p>Following is a sample code covering the implementation steps mentioned in the above paragraph:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class CustomDiscovery extends AbstractDiscoveryStrategy {

    public CustomDiscovery(ILogger logger, Map&lt;String, Comparable&gt; properties) {
        super(logger, properties);
    }

    @Override
    public Iterable&lt;DiscoveryNode&gt; discoverNodes() {
        Iterable&lt;DiscoveryNode&gt; iterable = //TODO implementation
        return iterable;
    }

    @Override
    public PartitionGroupStrategy getPartitionGroupStrategy() {
        return new CustomPartitionGroupStrategy();
    }

    private class CustomPartitionGroupStrategy implements PartitionGroupStrategy {
        @Override
        public Iterable&lt;MemberGroup&gt; getMemberGroups() {
            Iterable&lt;MemberGroup&gt; iterable = //TODO implementation
            return iterable;
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging-configuration">5.9. Logging Configuration</h3>
<div class="paragraph">
<p>Hazelcast has a flexible logging configuration and does not depend on any logging framework except JDK logging. It has built-in adapters for a number of logging frameworks and it also supports custom loggers by providing logging interfaces.</p>
</div>
<div class="paragraph">
<p>To use built-in adapters, set the <code>hazelcast.logging.type</code> property to one of the predefined types below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>jdk</strong>: JDK logging (default)</p>
</li>
<li>
<p><strong>log4j</strong>: Log4j</p>
</li>
<li>
<p><strong>log4j2</strong>: Log4j2</p>
</li>
<li>
<p><strong>slf4j</strong>: Slf4j</p>
</li>
<li>
<p><strong>none</strong>: disable logging</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can set <code>hazelcast.logging.type</code> through declarative configuration, programmatic configuration, or JVM system property.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you choose to use <code>log4j</code>, <code>log4j2</code>, or <code>slf4j</code>, you should include the proper dependencies in the classpath.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Declarative Configuration</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">  ....
  &lt;properties&gt;
    &lt;property name="hazelcast.logging.type"&gt;log4j&lt;/property&gt;
    ....
  &lt;/properties&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic Configuration</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config() ;
config.setProperty( "hazelcast.logging.type", "log4j" );</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>System Property</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using JVM parameter: <code>java -Dhazelcast.logging.type=slf4j</code></p>
</li>
<li>
<p>Using System class: <code>System.setProperty( "hazelcast.logging.type", "none" );</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the provided logging mechanisms are not satisfactory, you can implement your own using the custom logging feature. To use it, implement the <code>com.hazelcast.logging.LoggerFactory</code> and <code>com.hazelcast.logging.ILogger</code> interfaces and set the system property <code>hazelcast.logging.class</code> as your custom <code>LoggerFactory</code> class name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">-Dhazelcast.logging.class=foo.bar.MyLoggingFactory</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also listen to logging events generated by Hazelcast runtime by registering <code>LogListener`s to `LoggingService</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">LogListener listener = new LogListener() {
  public void log( LogEvent logEvent ) {
    // do something
  }
};
HazelcastInstance instance = Hazelcast.newHazelcastInstance();
LoggingService loggingService = instance.getLoggingService();
loggingService.addLogListener( Level.INFO, listener );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Through the <code>LoggingService</code>, you can get the currently used ILogger implementation and log your own messages too.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are not using command line for configuring logging, you should be careful about Hazelcast classes. They may be defaulted to <code>jdk</code> logging before newly configured logging is read. When logging mechanism is selected, it will not change.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="other-network-configurations">5.10. Other Network Configurations</h3>
<div class="paragraph">
<p>All network related configurations are performed via the <code>network</code> element in the Hazelcast XML configuration file or the class <code>NetworkConfig</code> when using programmatic configuration. Following subsections describe the available configurations that you can perform under the <code>network</code> element.</p>
</div>
<div class="sect3">
<h4 id="public-address">5.10.1. Public Address</h4>
<div class="paragraph">
<p><code>public-address</code> overrides the public address of a member. By default, a member selects its socket address as its public address. But behind a network address translation (NAT), two endpoints (members) may not be able to see/access each other. If both members set their public addresses to their defined addresses on NAT, then that way they can communicate with each other. In this case, their public addresses are not an address of a local network interface but a virtual address defined by NAT. It is optional to set and useful when you have a private cloud. Note that, the value for this element should be given in the format <strong><code>host IP address:port number</code></strong>. See the following examples.</p>
</div>
<div class="paragraph">
<p><strong>Declarative:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;network&gt;
    &lt;public-address&gt;11.22.33.44:5555&lt;/public-address&gt;
&lt;/network&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config();
config.getNetworkConfig()
    .setPublicAddress( "11.22.33.44:5555" );</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="port">5.10.2. Port</h4>
<div class="paragraph">
<p>You can specify the ports that Hazelcast will use to communicate between cluster members. Its default value is <code>5701</code>. The following are example configurations.</p>
</div>
<div class="paragraph">
<p><strong>Declarative:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;network&gt;
  &lt;port port-count="20" auto-increment="true"&gt;5701&lt;/port&gt;
&lt;/network&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config();
config.getNetworkConfig().setPort( 5701 )
    .setPortAutoIncrement( true ).setPortCount( 20 );</code></pre>
</div>
</div>
<div class="paragraph">
<p>According to the above example, Hazelcast will try to find free ports between 5701 and 5720.</p>
</div>
<div class="paragraph">
<p><code>port</code> has the following attributes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>port-count</code>: By default, Hazelcast will try 100 ports to bind. Meaning that, if you set the value of port as 5701, as members are joining to the cluster, Hazelcast tries to find ports between 5701 and 5801. You can choose to change the port count in the cases like having large instances on a single machine or willing to have only a few ports to be assigned. The parameter <code>port-count</code> is used for this purpose, whose default value is 100.</p>
</li>
<li>
<p><code>auto-increment</code>:  In some cases you may want to choose to use only one port. In that case, you can disable the auto-increment feature of <code>port</code> by setting <code>auto-increment</code> to <code>false</code>. The <code>port-count</code> attribute is not used when auto-increment feature is disabled.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="outbound-ports">5.10.3. Outbound Ports</h4>
<div class="paragraph">
<p>By default, Hazelcast lets the system pick up an ephemeral port during socket bind operation. But security policies/firewalls may require you to restrict outbound ports to be used by Hazelcast-enabled applications. To fulfill this requirement, you can configure Hazelcast to use only defined outbound ports. The following are example configurations.</p>
</div>
<div class="paragraph">
<p><strong>Declarative:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;network&gt;
  &lt;outbound-ports&gt;
    &lt;!-- ports between 33000 and 35000 --&gt;
    &lt;ports&gt;33000-35000&lt;/ports&gt;
    &lt;!-- comma separated ports --&gt;
    &lt;ports&gt;37000,37001,37002,37003&lt;/ports&gt;
    &lt;ports&gt;38000,38500-38600&lt;/ports&gt;
  &lt;/outbound-ports&gt;
&lt;/network&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
NetworkConfig networkConfig = config.getNetworkConfig();
// ports between 35000 and 35100
networkConfig.addOutboundPortDefinition("35000-35100");
// comma separated ports
networkConfig.addOutboundPortDefinition("36001, 36002, 36003");
networkConfig.addOutboundPort(37000);
networkConfig.addOutboundPort(37001);
...</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can use port ranges and/or comma separated ports.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As shown in the programmatic configuration, you use the method <code>addOutboundPort</code> to add only one port. If you need to add a group of ports, then use the method <code>addOutboundPortDefinition</code>.</p>
</div>
<div class="paragraph">
<p>In the declarative configuration, the element <code>ports</code> can be used for both single and multiple port definitions. When you set this element to  <code>0</code> or  <code>*</code>, your operating system (not Hazelcast) will select a free port from the ephemeral range.</p>
</div>
</div>
<div class="sect3">
<h4 id="reuse-address">5.10.4. Reuse Address</h4>
<div class="paragraph">
<p>When you shutdown a cluster member, the server socket port will be in the <code>TIME_WAIT</code> state for the next couple of minutes. If you start the member right after shutting it down, you may not be able to bind it to the same port because it is in the <code>TIME_WAIT</code> state. If you set the <code>reuse-address</code> element to <code>true</code>, the <code>TIME_WAIT</code> state is ignored and you can bind the member to the same port again.</p>
</div>
<div class="paragraph">
<p>The following are example configurations.</p>
</div>
<div class="paragraph">
<p><strong>Declarative:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;network&gt;
  &lt;reuse-address&gt;true&lt;/reuse-address&gt;
&lt;/network&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
NetworkConfig networkConfig = config.getNetworkConfig();

networkConfig.setReuseAddress( true );
...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="join">5.10.5. Join</h4>
<div class="paragraph">
<p>The <code>join</code> configuration element is used to discover Hazelcast members and enable them to form a cluster. Hazelcast provides multicast, TCP/IP, EC2, and jclouds&reg; discovery mechanisms. These mechanisms are explained the <a href="#discovery-mechanisms">Discovery Mechanisms section</a>. This section describes all the sub-elements and attributes of <code>join</code> element. The following are example configurations.</p>
</div>
<div class="paragraph">
<p><strong>Declarative:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;network&gt;
     &lt;join&gt;
         &lt;multicast enabled="true"&gt;
             &lt;multicast-group&gt;224.2.2.3&lt;/multicast-group&gt;
             &lt;multicast-port&gt;54327&lt;/multicast-port&gt;
             &lt;multicast-time-to-live&gt;32&lt;/multicast-time-to-live&gt;
             &lt;multicast-timeout-seconds&gt;2&lt;/multicast-timeout-seconds&gt;
             &lt;trusted-interfaces&gt;
                &lt;interface&gt;192.168.1.102&lt;/interface&gt;
             &lt;/trusted-interfaces&gt;
         &lt;/multicast&gt;
         &lt;tcp-ip enabled="false"&gt;
             &lt;required-member&gt;192.168.1.104&lt;/required-member&gt;
             &lt;member&gt;192.168.1.104&lt;/member&gt;
             &lt;members&gt;192.168.1.105,192.168.1.106&lt;/members&gt;
         &lt;/tcp-ip&gt;
         &lt;aws enabled="false"&gt;
             &lt;access-key&gt;my-access-key&lt;/access-key&gt;
             &lt;secret-key&gt;my-secret-key&lt;/secret-key&gt;
             &lt;region&gt;us-west-1&lt;/region&gt;
             &lt;host-header&gt;ec2.amazonaws.com&lt;/host-header&gt;
             &lt;security-group-name&gt;hazelcast-sg&lt;/security-group-name&gt;
             &lt;tag-key&gt;type&lt;/tag-key&gt;
             &lt;tag-value&gt;hz-members&lt;/tag-value&gt;
         &lt;/aws&gt;
         &lt;discovery-strategies&gt;
           &lt;discovery-strategy ... /&gt;
         &lt;/discovery-strategies&gt;
     &lt;/join&gt;
&lt;/network&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config();
NetworkConfig network = config.getNetworkConfig();
JoinConfig join = network.getJoin();
join.getMulticastConfig().setEnabled( false )
            .addTrustedInterface( "192.168.1.102" );
join.getTcpIpConfig().addMember( "10.45.67.32" ).addMember( "10.45.67.100" )
            .setRequiredMember( "192.168.10.100" ).setEnabled( true );</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>join</code> element has the following sub-elements and attributes.</p>
</div>
<div class="sect4">
<h5 id="multicase-element">multicast element</h5>
<div class="paragraph">
<p>The <code>multicast</code> element includes parameters to fine tune the multicast join mechanism.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: Specifies whether the multicast discovery is enabled or not, <code>true</code> or <code>false</code>.</p>
</li>
<li>
<p><code>multicast-group</code>: The multicast group IP address. Specify it when you want to create clusters within the same network. Values can be between 224.0.0.0 and 239.255.255.255. Default value is 224.2.2.3.</p>
</li>
<li>
<p><code>multicast-port</code>: The multicast socket port that the Hazelcast member listens to and sends discovery messages through. Default value is 54327.</p>
</li>
<li>
<p><code>multicast-time-to-live</code>: Time-to-live value for multicast packets sent out to control the scope of multicasts. See more information <a href="http://www.tldp.org/HOWTO/Multicast-HOWTO-2.html">here</a>.</p>
</li>
<li>
<p><code>multicast-timeout-seconds</code>: Only when the members are starting up, this timeout (in seconds) specifies the period during which a member waits for a multicast response from another member. For example, if you set it as 60 seconds, each member will wait for 60 seconds until a leader member is selected. Its default value is 2 seconds.</p>
</li>
<li>
<p><code>trusted-interfaces</code>: Includes IP addresses of trusted members. When a member wants to join to the cluster, its join request will be rejected if it is not a trusted member. You can give an IP addresses range using the wildcard (*) on the last digit of IP address, e.g., 192.168.1.\* or 192.168.1.100-110.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tcp-ip-element">tcp-ip element</h5>
<div class="paragraph">
<p>The <code>tcp-ip</code> element includes parameters to fine tune the TCP/IP join mechanism.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: Specifies whether the TCP/IP discovery is enabled or not. Values can be <code>true</code> or <code>false</code>.</p>
</li>
<li>
<p><code>required-member</code>: IP address of the required member. Cluster will only formed if the member with this IP address is found.</p>
</li>
<li>
<p><code>member</code>: IP address(es) of one or more well known members. Once members are connected to these well known ones, all member addresses will be communicated with each other. You can also give comma separated IP addresses using the <code>members</code> element.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>tcp-ip</code> element also accepts the <code>interface</code> parameter. Please refer to the <a href="#interfaces">Interfaces element description</a>.*
</td>
</tr>
</table>
</div>
</li>
<li>
<p><code>connection-timeout-seconds</code>: Defines the connection timeout. This is the maximum amount of time Hazelcast is going to try to connect to a well known member before giving up. Setting it to a too low value could mean that a member is not able to connect to a cluster. Setting it to a too high value means that member startup could slow down because of longer timeouts, for example when a well known member is not up. Increasing this value is recommended if you have many IPs listed and the members cannot properly build up the cluster. Its default value is 5.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aws-element">aws element</h5>
<div class="paragraph">
<p>The <code>aws</code> element includes parameters to allow the members to form a cluster on the Amazon EC2 environment.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: Specifies whether the EC2 discovery is enabled or not, <code>true</code> or <code>false</code>.</p>
</li>
<li>
<p><code>access-key</code>, <code>secret-key</code>: Access and secret keys of your account on EC2.</p>
</li>
<li>
<p><code>region</code>: The region where your members are running. Default value is <code>us-east-1</code>. You need to specify this if the region is other than the default one.</p>
</li>
<li>
<p><code>host-header</code>: The URL that is the entry point for a web service. It is optional.</p>
</li>
<li>
<p><code>security-group-name</code>: Name of the security group you specified at the EC2 management console. It is used to narrow the Hazelcast members to be within this group. It is optional.</p>
</li>
<li>
<p><code>tag-key</code>, <code>tag-value</code>: To narrow the members in the cloud down to only Hazelcast members, you can set these parameters as the ones you specified in the EC2 console. They are optional.</p>
</li>
<li>
<p><code>connection-timeout-seconds</code>: The maximum amount of time Hazelcast will try to connect to a well known member before giving up. Setting this value too low could mean that a member is not able to connect to a cluster. Setting the value too high means that member startup could slow down because of longer timeouts (for example, when a well known member is not up). Increasing this value is recommended if you have many IPs listed and the members cannot properly build up the cluster. Its default value is 5.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are using a cloud provider other than AWS, you can use the programmatic configuration to specify a TCP/IP cluster. The members will need to be retrieved from that provider, e.g., jclouds.</p>
</div>
</div>
<div class="sect4">
<h5 id="discovery-strategies-element">discovery-strategies element</h5>
<div class="paragraph">
<p>The <code>discovery-strategies</code> element configures internal or external discovery strategies based on the Hazelcast Discovery SPI. For further information, please refer to the <a href="#discovery-spi">Discovery SPI section</a> and the vendor documentation of the used discovery strategy.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="awsclient-configuration">5.10.6. AWSClient Configuration</h4>
<div class="paragraph">
<p>To make sure EC2 instances are found correctly, you can use the <code>AWSClient</code> class. It determines the private IP addresses of EC2 instances to be connected. Give the <code>AWSClient</code> class the values for the parameters that you specified in the <code>aws</code> element, as shown below. You will see whether your EC2 instances are found.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main( String[] args )throws Exception{
  AwsConfig config = new AwsConfig();
  config.setSecretKey( ... ) ;
  config.setSecretKey( ... );
  config.setRegion( ... );
  config.setSecurityGroupName( ... );
  config.setTagKey( ... );
  config.setTagValue( ... );
  config.setEnabled( true );
  AWSClient client = new AWSClient( config );
  Collection&lt;String&gt; ipAddresses = client.getPrivateIpAddresses();
  System.out.println( "addresses found:" + ipAddresses );
  for ( String ip: ipAddresses ) {
    System.out.println( ip );
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="interfaces">5.10.7. Interfaces</h4>
<div class="paragraph">
<p>You can specify which network interfaces that Hazelcast should use. Servers mostly have more than one network interface, so you may want to list the valid IPs. Range characters ('*' and '-') can be used for simplicity. For instance, 10.3.10.\* refers to IPs between 10.3.10.0 and 10.3.10.255. Interface 10.3.10.4-18 refers to IPs between 10.3.10.4 and 10.3.10.18 (4 and 18 included). If network interface configuration is enabled (it is disabled by default) and if Hazelcast cannot find a matching interface, then it will print a message on the console and will not start on that member.</p>
</div>
<div class="paragraph">
<p>The following are example configurations.</p>
</div>
<div class="paragraph">
<p><strong>Declarative:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;hazelcast&gt;
  ...
  &lt;network&gt;
    ...
    &lt;interfaces enabled="true"&gt;
      &lt;interface&gt;10.3.16.*&lt;/interface&gt;
      &lt;interface&gt;10.3.10.4-18&lt;/interface&gt;
      &lt;interface&gt;192.168.1.3&lt;/interface&gt;
    &lt;/interfaces&gt;
  &lt;/network&gt;
  ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config();
NetworkConfig network = config.getNetworkConfig();
InterfacesConfig interfaceConfig = network.getInterfaces();
interfaceConfig.setEnabled( true )
            .addInterface( "192.168.1.3" );</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ipv6-support">5.10.8. IPv6 Support</h4>
<div class="paragraph">
<p>Hazelcast supports IPv6 addresses seamlessly (This support is switched off by default, please see the note at the end of this section).</p>
</div>
<div class="paragraph">
<p>All you need is to define IPv6 addresses or interfaces in the network configuration. The only current limitation is that you cannot define wildcard IPv6 addresses in the TCP/IP join configuration (<code>tcp-ip</code> element). <a href="#interfaces">Interfaces</a> configuration does not have this limitation, you can configure wildcard IPv6 interfaces in the same way as IPv4 interfaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;hazelcast&gt;
  ...
  &lt;network&gt;
    &lt;port auto-increment="true"&gt;5701&lt;/port&gt;
    &lt;join&gt;
      &lt;multicast enabled="false"&gt;
        &lt;multicast-group&gt;FF02:0:0:0:0:0:0:1&lt;/multicast-group&gt;
        &lt;multicast-port&gt;54327&lt;/multicast-port&gt;
      &lt;/multicast&gt;
      &lt;tcp-ip enabled="true"&gt;
        &lt;member&gt;[fe80::223:6cff:fe93:7c7e]:5701&lt;/member&gt;
        &lt;interface&gt;192.168.1.0-7&lt;/interface&gt;
        &lt;interface&gt;192.168.1.*&lt;/interface&gt;
        &lt;interface&gt;fe80:0:0:0:45c5:47ee:fe15:493a&lt;/interface&gt;
      &lt;/tcp-ip&gt;
    &lt;/join&gt;
    &lt;interfaces enabled="true"&gt;
      &lt;interface&gt;10.3.16.*&lt;/interface&gt;
      &lt;interface&gt;10.3.10.4-18&lt;/interface&gt;
      &lt;interface&gt;fe80:0:0:0:45c5:47ee:fe15:*&lt;/interface&gt;
      &lt;interface&gt;fe80::223:6cff:fe93:0-5555&lt;/interface&gt;
    &lt;/interfaces&gt;
    ...
  &lt;/network&gt;
  ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>JVM has two system properties for setting the preferred protocol stack (IPv4 or IPv6) as well as the preferred address family types (inet4 or inet6). On a dual stack machine, IPv6 stack is preferred by default, you can change this through the <code>java.net.preferIPv4Stack=&lt;true|false&gt;</code> system property. When querying name services, JVM prefers IPv4 addresses over IPv6 addresses and will return an IPv4 address if possible. You can change this through <code>java.net.preferIPv6Addresses=&lt;true|false&gt;</code> system property.</p>
</div>
<div class="paragraph">
<p>Also see additional <a href="http://docs.oracle.com/javase/1.5.0/docs/guide/net/ipv6_guide/">details on IPv6 support in Java</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
IPv6 support has been switched off by default, since some platforms have issues using the IPv6 stack. Some other platforms such as Amazon AWS have no support at all. To enable IPv6 support, just set configuration property <code>hazelcast.prefer.ipv4.stack</code> to <strong>false</strong>. Please refer to the <a href="#system-properties">System Properties section</a> for details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="member-address-provides-spi">5.10.9. Member Address Provider SPI</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This SPI is not intended to provide addresses of other cluster members with which the Hazelcast instance will form a cluster. To do that, refer to the other network configuration sections above.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, Hazelcast chooses the public and bind address. You can influence on the choice by defining a <code>public-address</code> in the configuration or by using other properties mentioned above. In some cases, though, these properties are not enough and the default address picking strategy will choose wrong addresses. This may be the case when deploying Hazelcast in some cloud environments, such as AWS, when using Docker or when the instance is deployed behind a NAT and the <code>public-address</code> property is not enough (please see the <a href="#public-address">Public Address section</a>).</p>
</div>
<div class="paragraph">
<p>In these cases, it is possible to configure the bind and public address in a more advanced way. You can provide an implementation of the <code>com.hazelcast.spi.MemberAddressProvider</code> interface which will provide the bind and public address. The implementation may then choose these addresses in any way - it may read from a system property or file or even invoke a web service to retrieve the public and private address.</p>
</div>
<div class="paragraph">
<p>The details of the implementation depend heavily on the environment in which Hazelcast is deployed. As such, we will demonstrate how to configure Hazelcast to use a simplified custom member address provider SPI implementation. An example of an implementation is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static final class SimpleMemberAddressProvider implements MemberAddressProvider {
    @Override
    public InetSocketAddress getBindAddress() {
        // determine the address using some configuration, calling an API, ...
        return new InetSocketAddress(hostname, port);
    }

    @Override
    public InetSocketAddress getPublicAddress() {
        // determine the address using some configuration, calling an API, ...
        return new InetSocketAddress(hostname, port);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if the bind address port is <code>0</code> then it will use a port as configured in the Hazelcast network configuration (see the <a href="#port">Port section</a>). If the public address port is set to <code>0</code> then it will broadcast the same port that it is bound to. If you wish to bind to any local interface, you may return <code>new InetSocketAddress((InetAddress) null, port)</code> from the <code>getBindAddress()</code> address.</p>
</div>
<div class="paragraph">
<p>The following configuration examples contain properties that will be provided to the constructor of the provided class. If you do not provide any properties, the class may have either a no-arg constructor or a constructor accepting a single <code>java.util.Properties</code> instance. On the other hand, if you do provide properties in the configuration, the class must have a constructor accepting a single <code>java.util.Properties</code> instance.</p>
</div>
<div class="paragraph">
<p><strong>Declarative:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;network&gt;
     &lt;member-address-provider enabled="true"&gt;
         &lt;class-name&gt;SimpleMemberAddressProvider&lt;/class-name&gt;
         &lt;properties&gt;
             &lt;property name="prop1"&gt;prop1-value&lt;/property&gt;
             &lt;property name="prop2"&gt;prop2-value&lt;/property&gt;
         &lt;/properties&gt;
     &lt;/member-address-provider&gt;
     &lt;!-- other network configuration --&gt;
&lt;/network&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = new Config();
MemberAddressProviderConfig memberAddressProviderConfig = config.getNetworkConfig().getMemberAddressProviderConfig();
memberAddressProviderConfig
      .setEnabled(true)
      .setClassName(MemberAddressProviderWithStaticProperties.class.getName());
Properties properties = memberAddressProviderConfig.getProperties();
properties.setProperty("prop1", "prop1-value");
properties.setProperty("prop2", "prop2-value");

config.getNetworkConfig().getJoin().getMulticastConfig().setEnabled(false);

// perform other configuration

Hazelcast.newHazelcastInstance(config);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="failure-detector-configuration">5.11. Failure Detector Configuration</h3>
<div class="paragraph">
<p>A failure detector is responsible to determine if a member in the cluster is unreachable or crashed. The most important problem in failure detection is to distinguish whether a member is still alive but slow or has crashed. But according to the famous <a href="http://dl.acm.org/citation.cfm?doid=3149.214121">FLP result</a>, it is impossible to distinguish a crashed member from a slow one in an asynchronous system. A workaround to this limitation is to use unreliable failure detectors. An unreliable failure detector allows a member to suspect that others have failed, usually based on liveness criteria but it can make mistakes to a certain degree.</p>
</div>
<div class="paragraph">
<p>Hazelcast has two built-in failure detectors; Deadline Failure Detector and Phi Accrual Failure Detector.</p>
</div>
<div class="paragraph">
<p>Since 3.9.1, Hazelcast provides yet another failure detector, Ping Failure Detector, that, if enabled, works in parallel with the above ones, but identifies
failures on OSI Layer 3 (Network Layer). This detector is by default disabled.</p>
</div>
<div class="paragraph">
<p>Note that, Hazelcast also offers failure detectors for its Java client. Please refer to the <a href="#client-failure-detectors">Client Failure Detectors section</a> for more information.</p>
</div>
<div class="sect3">
<h4 id="deadline-failre-detector">5.11.1. Deadline Failure Detector</h4>
<div class="paragraph">
<p><em>Deadline Failure Detector</em> uses an absolute timeout for missing/lost heartbeats. After timeout, a member is considered as crashed/unavailable and marked as suspected.</p>
</div>
<div class="paragraph">
<p><em>Deadline Failure Detector</em> has two configuration properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.heartbeat.interval.seconds</code>: This is the interval at which member heartbeat messages are sent to each other.</p>
</li>
<li>
<p><code>hazelcast.max.no.heartbeat.seconds</code>: This is the timeout which defines when a cluster member is suspected because it has not sent any heartbeats.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use <em>Deadline Failure Detector</em> configuration property <code>hazelcast.heartbeat.failuredetector.type</code> should be set to <code>"deadline"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;hazelcast&gt;
    [...]
	&lt;properties&gt;
        &lt;property name="hazelcast.heartbeat.failuredetector.type"&gt;deadline&lt;/property&gt;
        &lt;property name="hazelcast.heartbeat.interval.seconds"&gt;5&lt;/property&gt;
        &lt;property name="hazelcast.max.no.heartbeat.seconds"&gt;120&lt;/property&gt;
        [...]
    &lt;/properties&gt;
    [...]
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = ...;
config.setProperty("hazelcast.heartbeat.failuredetector.type", "deadline");
config.setProperty("hazelcast.heartbeat.interval.seconds", "5");
config.setProperty("hazelcast.max.no.heartbeat.seconds", "120");
[...]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>Deadline Failure Detector</em> is the default failure detector in Hazelcast.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="phi-accrual-failure-detector">5.11.2. Phi Accrual Failure Detector</h4>
<div class="paragraph">
<p>This is the failure detector based on <a href="https://www.computer.org/csdl/proceedings/srds/2004/2239/00/22390066-abs.html">The Phi Accrual Failure Detector' by Hayashibara et al.</a></p>
</div>
<div class="paragraph">
<p>Phi Accrual Failure Detector keeps track of the intervals between heartbeats in a sliding window of time and measures the mean and variance of these samples and calculates a value of suspicion level (Phi). The value of phi will increase when the period since the last heartbeat gets longer. If the network becomes slow or unreliable, the resulting mean and variance will increase, there will need to be a longer period for which no heartbeat is received before the member is suspected. </p>
</div>
<div class="paragraph">
<p><code>hazelcast.heartbeat.interval.seconds</code> and <code>hazelcast.max.no.heartbeat.seconds</code> properties will still be used as period of heartbeat messages and deadline of heartbeat messages. Since <em>Phi Accrual Failure Detector</em> is adaptive to network conditions, a much lower <code>hazelcast.max.no.heartbeat.seconds</code> can be defined than <em>Deadline Failure Detector</em>'s timeout.</p>
</div>
<div class="paragraph">
<p>Additional to above two properties, <em>Phi Accrual Failure Detector</em> has three more configuration properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.heartbeat.phiaccrual.failuredetector.threshold</code>: This is the phi threshold for suspicion. After calculated phi exceeds this threshold, a member is considered as unreachable and marked as suspected. A low threshold allows to detect member crashes/failures faster but can generate more mistakes and cause wrong member suspicions. A high threshold generates fewer mistakes but is slower to detect actual crashes/failures.</p>
<div class="paragraph">
<p><code>phi = 1</code> means likeliness that we will make a mistake is about <code>10%</code>. The likeliness is about <code>1%</code> with <code>phi = 2</code>, <code>0.1%</code> with <code>phi = 3</code>, and so on. Default phi threshold is 10.</p>
</div>
</li>
<li>
<p><code>hazelcast.heartbeat.phiaccrual.failuredetector.sample.size</code>: Number of samples to keep for history. Default value is 200.</p>
</li>
<li>
<p><code>hazelcast.heartbeat.phiaccrual.failuredetector.min.std.dev.millis</code>: Minimum standard deviation to use for the normal distribution used when calculating phi. Too low standard deviation might result in too much sensitivity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use <em>Phi Accrual Failure Detector</em>, configuration property <code>hazelcast.heartbeat.failuredetector.type</code> should be set to <code>"phi-accrual"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;hazelcast&gt;
    [...]
	&lt;properties&gt;
        &lt;property name="hazelcast.heartbeat.failuredetector.type"&gt;phi-accrual&lt;/property&gt;
        &lt;property name="hazelcast.heartbeat.interval.seconds"&gt;1&lt;/property&gt;
        &lt;property name="hazelcast.max.no.heartbeat.seconds"&gt;60&lt;/property&gt;
        &lt;property name="hazelcast.heartbeat.phiaccrual.failuredetector.threshold"&gt;10&lt;/property&gt;
        &lt;property name="hazelcast.heartbeat.phiaccrual.failuredetector.sample.size"&gt;200&lt;/property&gt;
        &lt;property name="hazelcast.heartbeat.phiaccrual.failuredetector.min.std.dev.millis"&gt;100&lt;/property&gt;
        [...]
    &lt;/properties&gt;
    [...]
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Config config = ...;
config.setProperty("hazelcast.heartbeat.failuredetector.type", "phi-accrual");
config.setProperty("hazelcast.heartbeat.interval.seconds", "1");
config.setProperty("hazelcast.max.no.heartbeat.seconds", "60");
config.setProperty("hazelcast.heartbeat.phiaccrual.failuredetector.threshold", "10");
config.setProperty("hazelcast.heartbeat.phiaccrual.failuredetector.sample.size", "200");
config.setProperty("hazelcast.heartbeat.phiaccrual.failuredetector.min.std.dev.millis", "100");
[...]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ping-failure-detector">5.11.3. Ping Failure Detector</h4>
<div class="paragraph">
<p>The Ping Failure Detector may be configured in addition to one of Deadline and Phi Accual Failure Detectors. It operates at Layer 3 of the OSI protocol, and provides much quicker and more deterministic detection of hardware and other lower level events. This detector may be configured to perform an extra check after a member is suspected by one of the other detectors, or it can work in parallel, which is the default. This way hardware and network level issues will be detected more quickly.</p>
</div>
<div class="paragraph">
<p>This failure detector is based on <code>InetAddress.isReachable()</code>.
When the JVM process has enough permissions to create RAW sockets, the implementation will choose to rely on ICMP Echo requests. This is preferred.</p>
</div>
<div class="paragraph">
<p>If there are not enough permissions, it can be configured to fallback on attempting a TCP Echo on port 7. In the latter case, both a successful connection or an explicit rejection will be treated as "Host is Reachable". Or, it can be forced to use only RAW sockets. This is not preferred as each call creates a heavy weight socket and moreover the Echo service is typically disabled.</p>
</div>
<div class="paragraph">
<p>For the Ping Failure Detector to rely <strong>only</strong> on ICMP Echo requests, there are some criteria that need to be met.</p>
</div>
<div class="sect4">
<h5 id="requirements-and-linuxunix-configuration">Requirements and Linux/Unix Configuration</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Supported OS: as of Java 1.8 only Linux/Unix environments are supported</strong>. This detector relies on ICMP, i.e., the protocol behind the <code>ping</code> command. It tries to issue the ping attempts periodically, and their responses are used to determine the reachability of the remote member. However, you cannot simply create an ICMP Echo Request because these type of packets do not rely on any of the preexisting transport protocols such as TCP. In order to create such a request, you must have the privileges to create RAW sockets (please see <a href="https://linux.die.net/man/7/raw">https://linux.die.net/man/7/raw</a>). Most operating systems allow this to the root users, however Unix based ones are more flexible and allow the use of custom privileges per process
instead of requiring root access. Therefore, this detector is supported only on Linux.</p>
</li>
<li>
<p><strong>The Java executable must have the <code>cap_net_raw</code> capability.</strong> As described in the above requirement, on Linux, you have the ability to define extra capabilities to a single process, which would allow the process to interact with the RAW sockets. This interaction is achieved via the capability <code>cap_net_raw</code> (please see <a href="https://linux.die.net/man/7/capabilities">https://linux.die.net/man/7/capabilities</a>). To enable this capability run the following command:</p>
<div class="paragraph">
<p><code>sudo setcap cap_net_raw=+ep &lt;JDK_HOME&gt;/jre/bin/java</code></p>
</div>
</li>
<li>
<p><strong>When running with custom capabilities, the dynamic linker on Linux will reject loading libs from untrusted paths.</strong> Since you have now <code>cap_net_raw</code> as a custom capability for a process, it becomes suspicious to the dynamic linker and it will throw an error: <code>java: error while loading shared libraries: libjli.so: cannot open shared object file: No such file or directory</code></p>
<div class="ulist">
<ul>
<li>
<p>To overcome this rejection, the <code>&lt;JDK_HOME&gt;/jre/lib/amd64/jli/</code> path needs to be added in the <code>ld.conf</code>. Run the following command to do this: <code>echo "&lt;JDK_HOME&gt;/jre/lib/amd64/jli/" &gt;&gt; /etc/ld.so.conf.d/java.conf &amp;&amp; sudo ldconfig</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>ICMP Echo Requests must not be blocked by the receiving hosts.</strong> <code>/proc/sys/net/ipv4/icmp_echo_ignore_all</code> set to <code>0</code>. Run the following command:</p>
<div class="paragraph">
<p><code>echo 0 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all</code></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of the above criteria isn&#8217;t met, then the <code>isReachable</code> will always fallback on TCP Echo attempts on port 7.</p>
</div>
<div class="paragraph">
<p>To be able to use the Ping Failure Detector, please add the following properties in your Hazelcast declarative configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;hazelcast&gt;
    [...]
	&lt;properties&gt;
        &lt;property name="hazelcast.icmp.enabled"&gt;true&lt;/property&gt;
        &lt;property name="hazelcast.icmp.parallel.mode"&gt;true&lt;/property&gt;
        &lt;property name="hazelcast.icmp.timeout"&gt;1000&lt;/property&gt;
        &lt;property name="hazelcast.icmp.max.attempts"&gt;3&lt;/property&gt;
        &lt;property name="hazelcast.icmp.interval"&gt;1000&lt;/property&gt;
        &lt;property name="hazelcast.icmp.ttl"&gt;0&lt;/property&gt;
        [...]
    &lt;/properties&gt;
    [...]
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.icmp.enabled</code> (default false) - Enables legacy ICMP detection mode, works cooperatively with the existing failure detector, and only kicks-in after a pre-defined period has passed with no heartbeats from a member.</p>
</li>
<li>
<p><code>hazelcast.icmp.parallel.mode</code> (default true) - Enabling the parallel ping detector, works separately from the other detectors.</p>
</li>
<li>
<p><code>hazelcast.icmp.timeout</code> (default 1000) - Number of milliseconds until a ping attempt is considered failed if there was no reply.</p>
</li>
<li>
<p><code>hazelcast.icmp.max.attempts</code> (default 3) - The maximum number of ping attempts before the member/node gets suspected by the detector.</p>
</li>
<li>
<p><code>hazelcast.icmp.interval</code> (default 1000) - The interval, in milliseconds, between each ping attempt. 1000ms (1 sec) is also the minimum interval allowed.</p>
</li>
<li>
<p><code>hazelcast.icmp.ttl</code> (default 0) - The maximum number of hops the packets should go through or 0 for the default.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the above configuration, the Ping detector will attempt 3 pings, one every second and will wait up-to 1 second for each to complete. If after 3 seconds, there was no successful ping, the member will get suspected.</p>
</div>
<div class="paragraph">
<p>To enforce the [Requirements](#Requirements), the property <code>hazelcast.icmp.echo.fail.fast.on.startup</code> can also be set to <code>true</code>, in which case, if any of the requirements
isn&#8217;t met, Hazelcast will fail to start.</p>
</div>
<div class="paragraph">
<p>Below is a summary table of all possible configuration combinations of the ping failure detector.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Ping Failure Detector Possible Configuration Combinations</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ICMP</th>
<th class="tableblock halign-left valign-top">Parallel</th>
<th class="tableblock halign-left valign-top">Fail-Fast</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Linux</th>
<th class="tableblock halign-left valign-top">Windows</th>
<th class="tableblock halign-left valign-top">macOS</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Completely disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Legacy ping mode. This works hand-to-hand with the OSI Layer 7 failure detector (see. phi or deadline in sections above). Ping in this mode will only kick in after a period when there are no hearbeats received, in which case the remote Hazelcast member will be pinged up-to 5 times. If all 5 attempts fail, the member gets suspected.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported  ICMP Echo if available - Falls back on TCP Echo on port 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported  TCP Echo on port 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported ICMP Echo if available - Falls back on TCP Echo on port 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel ping detector, works in parallel with the configured failure detector. Checks periodically if members are live (OSI Layer 3), and suspects them immediately, regardless of the other detectors.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported  ICMP Echo if available - Falls back on TCP Echo on port 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported  TCP Echo on port 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported  ICMP Echo if available - Falls back on TCP Echo on port 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel ping detector, works in parallel with the configured failure detector. Checks periodically if members are live (OSI Layer 3), and suspects them immediately, regardless of the other detectors.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported - Requires OS Configuration  Enforcing ICMP Echo if available - No start up if not available</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Supported</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Supported - Requires root privileges</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-03-26 15:19:15 MSK
</div>
</div>
</body>
</html>